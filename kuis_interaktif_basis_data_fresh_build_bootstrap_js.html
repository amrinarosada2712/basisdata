<!doctype html>
<html lang="id">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kuis Interaktif Basis Data ‚Äî Bootstrap + JavaScript</title>
  <!-- Bootstrap 5 + Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <style>
    /* === Theme: Biru ‚Ä¢ Putih ‚Ä¢ Abu-abu === */
    :root {
      --bg: #ffffff;
      /* latar halaman = putih */
      --panel: #f1f5f9;
      /* panel lembut abu-abu */
      --ink: #0f172a;
      /* teks utama (biru tua-kehitaman) */
      --muted: #64748b;
      /* teks sekunder abu-abu */
      --primary: #0d6efd;
      /* biru Bootstrap sebagai aksen */
      --border: #e2e8f0;
      /* garis halus abu-abu muda */
    }

    body {
      background: var(--bg);
      color: var(--ink);
    }

    .app-shell {
      max-width: 1100px;
    }

    .card {
      border: 1px solid var(--border);
      border-radius: 1rem;
      box-shadow: 0 10px 30px rgba(2, 6, 23, .06);
      background: #ffffff;
    }

    .badge-q {
      width: 2.1rem;
      height: 2.1rem;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      font-weight: 700;
    }

    .drag-item {
      user-select: none;
    }

    .dropzone {
      min-height: 48px;
      border: 2px dashed #94a3b8;
      /* abu-abu */
      border-radius: .75rem;
      padding: .25rem .5rem;
      background: var(--panel);
    }

    .dropzone.filled {
      border-style: solid;
    }

    .code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      background: var(--panel);
      color: var(--ink);
      padding: .75rem 1rem;
      border-radius: .75rem;
      border: 1px solid var(--border);
    }

    /* Feedback warna tetap jelas */
    .is-correct {
      border: 2px solid #22c55e !important;
      background: #ecfdf5 !important;
    }

    .is-wrong {
      border: 2px solid #ef4444 !important;
      background: #fef2f2 !important;
    }

    .footer-muted {
      color: var(--muted);
    }

    /* ===== Overrides agar komponen "dark" jadi terang (biru/abu/putih) ===== */
    .bg-dark {
      background: #f8fafc !important;
    }

    /* abu-abu sangat muda */
    .text-light {
      color: var(--ink) !important;
    }

    /* balik ke teks gelap */
    .table-dark {
      --bs-table-color: var(--ink);
      --bs-table-bg: #ffffff;
      --bs-table-border-color: var(--border);
      --bs-table-striped-bg: #f8fafc;
      --bs-table-striped-color: var(--ink);
      --bs-table-hover-bg: #eef2f7;
      --bs-table-hover-color: var(--ink);
      color: var(--bs-table-color);
      border-color: var(--bs-table-border-color);
    }

    /* Tombol outline info ‚Üí biru */
    .btn-outline-info {
      --bs-btn-color: var(--primary);
      --bs-btn-border-color: var(--primary);
      --bs-btn-hover-bg: var(--primary);
      --bs-btn-hover-border-color: var(--primary);
      --bs-btn-active-bg: var(--primary);
      --bs-btn-active-border-color: var(--primary);
    }

    /* Progress bar pakai biru */
    .progress {
      background: #e9eef6;
      border-radius: .75rem;
      overflow: hidden;
    }

    .progress-bar.bg-info {
      background: var(--primary) !important;
    }

    /* Alerts & badges minor polish */
    .badge.text-bg-info {
      background: var(--primary) !important;
    }
  </style>

</head>

<body>
  <div class="container py-5 app-shell">

    <header class="text-center mb-4">
      <h1 class="fw-bold">Kuis Interaktif Basis Data</h1>
      <p class="lead mb-1">Bootstrap 5 + JavaScript ‚Äî cek otomatis, progres, skor & unduh hasil</p>
      <div class="small footer-muted">Jawab semua lalu klik <span class="fw-semibold">Periksa Jawaban</span>. Gunakan
        <span class="fw-semibold">Reset</span> untuk mengulang.
      </div>
    </header>

    <!-- ======= Kontrol Global: Nama, Progres, Aksi ======= -->
    <div class="d-flex flex-column gap-3 align-items-center mb-4">
      <div class="row g-2 w-100" style="max-width:900px;">
        <div class="col-md-5">
          <input id="studentName" class="form-control" placeholder="Nama peserta (opsional)" />
        </div>
        <div class="col-md-7">
          <div class="progress" role="progressbar" aria-label="Progres Pengerjaan" aria-valuemin="0" aria-valuemax="100"
            style="height: 32px;">
            <div id="progressBar" class="progress-bar bg-info fw-semibold" style="width: 0%">0%</div>
          </div>
          <div id="progressText" class="small text-center mt-1 text-secondary">0/0 soal terjawab ‚Ä¢ 0% selesai</div>
        </div>
      </div>
      <div class="d-flex gap-2 justify-content-center">
        <button id="checkAll" class="btn btn-success px-4">
          <i class="bi bi-check2-square"></i> Periksa Jawaban
        </button>
        <button id="resetAll" class="btn btn-outline-light px-4">
          <i class="bi bi-arrow-counterclockwise"></i> Reset
        </button>
        <button id="downloadReport" class="btn btn-primary px-4">
          <i class="bi bi-download"></i> Unduh Hasil
        </button>
        <span class="badge rounded-pill text-bg-info align-self-center" id="scoreBadge">Skor: 0</span>
      </div>
    </div>

    <!-- ======================== BAGIAN 1: PILIHAN GANDA ======================== -->
    <section class="card mb-4">
      <div class="card-body p-4">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <h2 class="h5 m-0">Bagian 1 ‚Äî Pilihan Ganda</h2>
          <span class="badge-q bg-primary">1</span>
        </div>

        <!-- Q1 -->
        <div class="mb-3" data-question="mcq" data-points="10" data-answer="b">
          <p class="mb-2 fw-semibold">1) Fungsi utama DBMS (Database Management System) adalah‚Ä¶</p>
          <div class="row row-cols-1 row-cols-md-2 g-2">
            <div class="col">
              <div class="form-check bg-dark text-light p-2 rounded">
                <input class="form-check-input" type="radio" name="q1" id="q1a" value="a">
                <label class="form-check-label" for="q1a">Menghapus semua data yang rusak</label>
              </div>
            </div>
            <div class="col">
              <div class="form-check bg-dark text-light p-2 rounded">
                <input class="form-check-input" type="radio" name="q1" id="q1b" value="b">
                <label class="form-check-label" for="q1b">Mengelola, menyimpan, dan mengakses data secara
                  efisien</label>
              </div>
            </div>
            <div class="col">
              <div class="form-check bg-dark text-light p-2 rounded">
                <input class="form-check-input" type="radio" name="q1" id="q1c" value="c">
                <label class="form-check-label" for="q1c">Membuat file dokumen</label>
              </div>
            </div>
            <div class="col">
              <div class="form-check bg-dark text-light p-2 rounded">
                <input class="form-check-input" type="radio" name="q1" id="q1d" value="d">
                <label class="form-check-label" for="q1d">Mengatur sistem operasi</label>
              </div>
            </div>
          </div>
          <div class="mt-2 small" data-feedback></div>
        </div>

        <!-- Q2 -->
        <div class="mb-3" data-question="mcq" data-points="10" data-answer="b">
          <p class="mb-2 fw-semibold">2) Pernyataan SQL yang benar untuk menampilkan kolom <code>nama</code> dari tabel
            <code>mahasiswa</code> adalah‚Ä¶
          </p>
          <div class="row row-cols-1 row-cols-md-2 g-2">
            <div class="col">
              <div class="form-check bg-dark text-light p-2 rounded">
                <input class="form-check-input" type="radio" name="q2" id="q2a" value="a">
                <label class="form-check-label" for="q2a"><code>SHOW nama FROM mahasiswa;</code></label>
              </div>
            </div>
            <div class="col">
              <div class="form-check bg-dark text-light p-2 rounded">
                <input class="form-check-input" type="radio" name="q2" id="q2b" value="b">
                <label class="form-check-label" for="q2b"><code>SELECT nama FROM mahasiswa;</code></label>
              </div>
            </div>
            <div class="col">
              <div class="form-check bg-dark text-light p-2 rounded">
                <input class="form-check-input" type="radio" name="q2" id="q2c" value="c">
                <label class="form-check-label" for="q2c"><code>DISPLAY nama FROM mahasiswa;</code></label>
              </div>
            </div>
            <div class="col">
              <div class="form-check bg-dark text-light p-2 rounded">
                <input class="form-check-input" type="radio" name="q2" id="q2d" value="d">
                <label class="form-check-label" for="q2d"><code>GET nama FROM mahasiswa;</code></label>
              </div>
            </div>
          </div>
          <div class="mt-2 small" data-feedback></div>
        </div>

        <!-- Q3 (Tambahan) -->
        <div class="mb-1" data-question="mcq" data-points="10" data-answer="a">
          <p class="mb-2 fw-semibold">3) <code>INNER JOIN</code> akan‚Ä¶</p>
          <div class="row row-cols-1 row-cols-md-2 g-2">
            <div class="col">
              <div class="form-check bg-dark text-light p-2 rounded">
                <input class="form-check-input" type="radio" name="q3" id="q3a" value="a">
                <label class="form-check-label" for="q3a">Mengembalikan baris yang cocok di kedua tabel</label>
              </div>
            </div>
            <div class="col">
              <div class="form-check bg-dark text-light p-2 rounded">
                <input class="form-check-input" type="radio" name="q3" id="q3b" value="b">
                <label class="form-check-label" for="q3b">Mengembalikan semua baris dari tabel kiri</label>
              </div>
            </div>
            <div class="col">
              <div class="form-check bg-dark text-light p-2 rounded">
                <input class="form-check-input" type="radio" name="q3" id="q3c" value="c">
                <label class="form-check-label" for="q3c">Menghapus baris yang tidak cocok</label>
              </div>
            </div>
            <div class="col">
              <div class="form-check bg-dark text-light p-2 rounded">
                <input class="form-check-input" type="radio" name="q3" id="q3d" value="d">
                <label class="form-check-label" for="q3d">Menambah kolom baru tanpa kecocokan</label>
              </div>
            </div>
          </div>
          <div class="mt-2 small" data-feedback></div>
        </div>
      </div>
    </section>

    <!-- ======================== BAGIAN 2: ISIAN OTOMATIS ======================== -->
    <section class="card mb-4">
      <div class="card-body p-4">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <h2 class="h5 m-0">Bagian 2 ‚Äî Isian Otomatis</h2>
          <span class="badge-q bg-primary">2</span>
        </div>

        <!-- Q4: INSERT -->
        <div class="mb-3" data-question="input" data-points="10"
          data-keywords='[{"type":"regex","pattern":"^\\s*INSERT\\s+INTO\\s+produk\\s*\\(\\s*id\\s*,\\s*nama\\s*,\\s*harga\\s*\\)\\s*VALUES\\s*\\(.*\\)\\s*;?\\s*$","flags":"i"}]'>
          <p class="fw-semibold mb-2">4) Tulis SQL untuk menambahkan data ke <code>produk(id, nama, harga)</code>.</p>
          <textarea class="form-control bg-dark text-light" rows="3"
            placeholder="INSERT INTO produk (id, nama, harga) VALUES (1, 'Pulpen', 2500);"></textarea>
          <div class="mt-2 small" data-feedback></div>
        </div>

        <!-- Q5: Normalisasi -->
        <div class="mb-3" data-question="input" data-points="10"
          data-keywords='[{"type":"includes","any":["redundansi","konsistensi","efisiensi","integritas"]}]'>
          <p class="fw-semibold mb-2">5) Sebutkan dua keuntungan normalisasi basis data.</p>
          <input class="form-control bg-dark text-light" placeholder="Tulis jawaban singkat‚Ä¶" />
          <div class="mt-2 small" data-feedback></div>
        </div>

        <!-- Q6: CREATE TABLE (Tambahan) -->
        <div class="mb-1" data-question="input" data-points="10"
          data-keywords='[{"type":"regex","pattern":"^\\s*CREATE\\s+TABLE\\s+mahasiswa\\s*\\(.*nim.*nama.*jurusan.*\\)\\s*;?\\s*$","flags":"i"}]'>
          <p class="fw-semibold mb-2">6) Tulis DDL untuk membuat tabel <code>mahasiswa(nim, nama, jurusan)</code>.</p>
          <textarea class="form-control bg-dark text-light" rows="3"
            placeholder="CREATE TABLE mahasiswa (nim VARCHAR(10) PRIMARY KEY, nama VARCHAR(100), jurusan VARCHAR(50));"></textarea>
          <div class="mt-2 small" data-feedback></div>
        </div>
      </div>
    </section>

    <!-- ======================== BAGIAN 3: MATCHING (DRAG & DROP) ======================== -->
    <section class="card mb-4">
      <div class="card-body p-4">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <h2 class="h5 m-0">Bagian 3 ‚Äî Cocokkan Pasangan (Drag & Drop)</h2>
          <span class="badge-q bg-primary">3</span>
        </div>
        <div class="row g-3" data-question="match" data-points="15"
          data-map='{"Primary Key":"Kolom unik dan tidak boleh NULL","Foreign Key":"Menghubungkan dua tabel","Query":"Perintah untuk mengambil atau memanipulasi data"}'>

          <!-- BANK ISTILAH -->
          <div class="col-md-5">
            <div class="bg-dark text-light p-3 rounded-3 h-100">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="fw-semibold">Bank Istilah</div>
                <button id="resetMatch" type="button" class="btn btn-sm btn-outline-light">Reset Bagian 3</button>
              </div>
              <div id="matchBank" class="d-grid gap-2">
                <button class="btn btn-outline-info drag-item" draggable="true" data-item="Primary Key">Primary
                  Key</button>
                <button class="btn btn-outline-info drag-item" draggable="true" data-item="Foreign Key">Foreign
                  Key</button>
                <button class="btn btn-outline-info drag-item" draggable="true" data-item="Query">Query</button>
              </div>
              <div class="small text-secondary mt-2">Tarik istilah ke kotak penjelasan yang sesuai. Satu istilah hanya
                boleh digunakan sekali.</div>
            </div>
          </div>

          <!-- TARGET PENJELASAN -->
          <div class="col-md-7">
            <div class="bg-dark text-light p-3 rounded-3">
              <div class="fw-semibold mb-2">Cocokkan ke Penjelasan</div>
              <div class="vstack gap-3">
                <div>
                  <div class="small text-secondary mb-1">Kolom unik dan tidak boleh NULL</div>
                  <div class="p-2 rounded dropzone dropzone-match" data-target="Kolom unik dan tidak boleh NULL"></div>
                </div>
                <div>
                  <div class="small text-secondary mb-1">Menghubungkan dua tabel</div>
                  <div class="p-2 rounded dropzone dropzone-match" data-target="Menghubungkan dua tabel"></div>
                </div>
                <div>
                  <div class="small text-secondary mb-1">Perintah untuk mengambil atau memanipulasi data</div>
                  <div class="p-2 rounded dropzone dropzone-match"
                    data-target="Perintah untuk mengambil atau memanipulasi data"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="mt-2 small" data-feedback></div>
        </div>
      </div>
    </section>

    <!-- ======================== MATERI: DELETE ======================== -->
    <section class="card mb-4">
      <div class="card-body p-4">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <h2 class="h5 m-0">Materi ‚Äî Menghapus Data di Dalam Tabel (<code>DELETE</code>)</h2>
          <span class="badge bg-warning text-dark">Materi</span>
        </div>
        <div class="row g-4">
          <!-- Kolom kiri -->
          <div class="col-lg-7">
            <div class="p-3 rounded-3" style="background:#0b1224;border:1px solid #23314f;">
              <div class="fw-semibold mb-2">1) Sintaks Dasar</div>
              <div class="code">DELETE FROM nama_tabel WHERE kondisi;</div>
              <div class="small text-secondary mt-1">Tanpa <code>WHERE</code>, <strong>semua baris</strong> akan
                terhapus.</div>
            </div>

            <div class="p-3 rounded-3 mt-3" style="background:#0b1224;border:1px solid #23314f;">
              <div class="fw-semibold mb-2">2) Contoh pada tabel <code>barang(id, nama, harga, stok)</code></div>
              <div class="code mb-2">-- Hapus berdasarkan id<br>DELETE FROM barang WHERE id = 3;</div>
              <div class="code mb-2">-- Hapus semua barang yang stoknya habis<br>DELETE FROM barang WHERE stok = 0;
              </div>
              <div class="code mb-2">-- Hapus semua barang yang namanya diawali "Pen"<br>DELETE FROM barang WHERE nama
                LIKE 'Pen%';</div>
              <div class="code mb-0">-- Hapus barang harga < 1500 ATAU stok < 10<br>DELETE FROM barang WHERE harga <
                    1500 OR stok < 10;</div>
              </div>

              <div class="p-3 rounded-3 mt-3" style="background:#0b1224;border:1px solid #23314f;">
                <div class="fw-semibold mb-2">3) <code>DELETE</code> vs <code>TRUNCATE</code></div>
                <ul class="small mb-2">
                  <li><code>DELETE</code>: bisa <code>WHERE</code>, tercatat di log transaksi, bisa <em>rollback</em>
                    (tergantung engine).</li>
                  <li><code>TRUNCATE</code>: hapus <em>semua</em> baris, reset AUTO_INCREMENT (umum), tidak memakai
                    <code>WHERE</code>.
                  </li>
                  <li>Beberapa DBMS membatasi <code>TRUNCATE</code> jika ada <em>foreign key</em>.</li>
                </ul>
                <div class="code">TRUNCATE TABLE barang; -- hati-hati!</div>
              </div>
            </div>

            <!-- Kolom kanan -->
            <div class="col-lg-5">
              <div class="alert alert-danger">
                <div class="fw-semibold mb-1">‚ö†Ô∏è Praktik Aman Saat Menghapus Data</div>
                <ul class="mb-0 ps-3">
                  <li>Uji dulu dengan <span class="code d-inline">SELECT * FROM barang WHERE ...</span></li>
                  <li>Pertimbangkan <span class="fw-semibold">soft delete</span> (kolom <code>is_deleted</code> +
                    <code>UPDATE</code>).
                  </li>
                  <li>Gunakan transaksi: <span class="code d-inline">BEGIN; ... DELETE ...; COMMIT;</span></li>
                  <li>Backup sebelum operasi massal.</li>
                </ul>
              </div>
              <div class="accordion" id="accDelete">
                <div class="accordion-item bg-dark text-light">
                  <h2 class="accordion-header"><button class="accordion-button collapsed" type="button"
                      data-bs-toggle="collapse" data-bs-target="#acc1">DELETE dengan JOIN (MySQL)</button></h2>
                  <div id="acc1" class="accordion-collapse collapse" data-bs-parent="#accDelete">
                    <div class="accordion-body">
                      <div class="code">DELETE b FROM barang b<br>JOIN pemasok p ON p.id = b.id_pemasok<br>WHERE p.aktif
                        = 0;</div>
                      <div class="small text-secondary">Menghapus baris <code>barang</code> yang terkait pemasok tidak
                        aktif.</div>
                    </div>
                  </div>
                </div>
                <div class="accordion-item bg-dark text-light">
                  <h2 class="accordion-header"><button class="accordion-button collapsed" type="button"
                      data-bs-toggle="collapse" data-bs-target="#acc2">Contoh Soft Delete</button></h2>
                  <div id="acc2" class="accordion-collapse collapse" data-bs-parent="#accDelete">
                    <div class="accordion-body">
                      <div class="code">ALTER TABLE barang ADD COLUMN is_deleted TINYINT(1) DEFAULT 0; -- tambah
                        kolom<br>UPDATE barang SET is_deleted = 1 WHERE id = 3; -- tandai terhapus<br>SELECT * FROM
                        barang WHERE is_deleted = 0; -- hanya data aktif</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <hr class="border-secondary my-4">
          <div class="small text-secondary">Latihan terkait materi ini ada pada Bagian 4 ‚Äî Simulasi Kueri SQL (soal
            hapus data).</div>
        </div>
    </section>

    <!-- ======================== BAGIAN 4: SIMULASI KUERI SQL ======================== -->
    <section class="card mb-4">
      <div class="card-body p-4">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <h2 class="h5 m-0">Bagian 4 ‚Äî Simulasi Kueri SQL</h2>
          <span class="badge-q bg-primary">4</span>
        </div>

        <div class="alert alert-secondary small" role="alert">
          Gunakan tabel <code>barang(id, nama, harga, stok)</code> dengan data contoh. Tulis kueri sesuai perintah.
        </div>
        <div class="table-responsive mb-3">
          <table class="table table-dark table-striped table-bordered align-middle mb-0">
            <caption class="text-light small">Data contoh untuk <code>barang</code></caption>
            <thead>
              <tr>
                <th scope="col">id</th>
                <th scope="col">nama</th>
                <th scope="col">harga</th>
                <th scope="col">stok</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Buku</td>
                <td>5000</td>
                <td>20</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Pulpen</td>
                <td>2000</td>
                <td>50</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Penghapus</td>
                <td>1000</td>
                <td>30</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Q7 -->
        <div class="mb-3" data-question="sql" data-points="10"
          data-answers='["SELECT * FROM barang WHERE harga > 2000;","SELECT * FROM barang WHERE harga>2000;"]'>
          <div class="fw-semibold mb-1">7) Tampilkan semua barang dengan harga di atas 2000.</div>
          <input class="form-control bg-dark text-light" placeholder="SELECT * FROM barang WHERE harga > 2000;" />
          <div class="mt-2 small" data-feedback></div>
        </div>

        <!-- Q8 -->
        <div class="mb-3" data-question="sql" data-points="10"
          data-answers='["UPDATE barang SET harga = 2500 WHERE nama = \' Pulpen\';","UPDATE barang SET harga=2500 WHERE
          nama=\'Pulpen\';"]'>
          <div class="fw-semibold mb-1">8) Ubah harga <code>Pulpen</code> menjadi 2500.</div>
          <input class="form-control bg-dark text-light"
            placeholder="UPDATE barang SET harga = 2500 WHERE nama = 'Pulpen';" />
          <div class="mt-2 small" data-feedback></div>
        </div>

        <!-- Q9 -->
        <div class="mb-1" data-question="sql" data-points="10"
          data-answers='["DELETE FROM barang WHERE id = 3;","DELETE FROM barang WHERE id=3;"]'>
          <div class="fw-semibold mb-1">9) Hapus barang dengan <code>id = 3</code>.</div>
          <input class="form-control bg-dark text-light" placeholder="DELETE FROM barang WHERE id = 3;" />
          <div class="mt-2 small" data-feedback></div>
        </div>
      </div>
    </section>

    <!-- ======================== BAGIAN 5: MINI GAME DEBUG SQL ======================== -->
    <section class="card mb-4">
      <div class="card-body p-4">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <h2 class="h5 m-0">Bagian 5 ‚Äî Mini Game ‚ÄúDebug SQL‚Äù</h2>
          <span class="badge-q bg-primary">5</span>
        </div>

        <!-- Q10 -->
        <div class="mb-3" data-question="debug" data-points="7"
          data-correct="SELECT nama, harga FROM produk WHERE stok >= 0;">
          <div class="fw-semibold mb-2">10) Perbaiki query salah berikut agar valid.</div>
          <div class="code mb-2">‚ùå SELECT nama harga FROM produk WHERE stok &gt;=;</div>
          <input class="form-control bg-dark text-light" placeholder="Ketik perbaikan‚Ä¶" />
          <div class="mt-2 small" data-feedback></div>
        </div>

        <!-- Q11 -->
        <div class="mb-1" data-question="debug" data-points="8"
          data-correct="UPDATE produk SET harga = 3000 WHERE id = 2;">
          <div class="fw-semibold mb-2">11) Perbaiki query salah berikut agar valid.</div>
          <div class="code mb-2">‚ùå UPDATA produk SET harga=3000 WHERE id=2;</div>
          <input class="form-control bg-dark text-light" placeholder="Ketik perbaikan‚Ä¶" />
          <div class="mt-2 small" data-feedback></div>
        </div>
      </div>
    </section>

    <!-- ======================== BAGIAN 6: STUDI KASUS MINI ======================== -->
    <section class="card mb-5">
      <div class="card-body p-4">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <h2 class="h5 m-0">Bagian 6 ‚Äî Studi Kasus Mini</h2>
          <span class="badge-q bg-primary">6</span>
        </div>

        <!-- Q12 -->
        <div class="mb-1" data-question="sql" data-points="10"
          data-answers='["SELECT * FROM transaksi WHERE total > 100000 AND tanggal >= \"2025-10-01\" AND tanggal < \"2025-11-01\";","SELECT * FROM transaksi WHERE total>100000 AND tanggal>=\"2025-10-01\" AND tanggal<\"2025-11-01\";"]'>
          <div class="fw-semibold mb-1">12) Tampilkan transaksi dengan <code>total &gt; 100000</code> pada
            <strong>Oktober 2025</strong>.
          </div>
          <input class="form-control bg-dark text-light"
            placeholder='SELECT * FROM transaksi WHERE total > 100000 AND tanggal >= "2025-10-01" AND tanggal < "2025-11-01";' />
          <div class="mt-2 small" data-feedback></div>
        </div>
      </div>
    </section>

    <footer class="text-center text-light-50 mb-4">
      <div class="footer-muted">¬© 2025 ‚Äî Kuis Interaktif Basis Data. Versi fresh build (Bootstrap + JavaScript).</div>
    </footer>
  </div>

  <!-- Bootstrap Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // ======= Global scoring/progress state =======
      let lastScore = 0;
      let lastAnswered = 0;
      const blocks = () => Array.from(document.querySelectorAll('[data-question]'));
      const MAX_POINTS = blocks().reduce((sum, b) => sum + (+b.dataset.points || 0), 0);

      // Utility: normalize SQL (trim, collapse spaces, ignore case, ensure semicolon optional)
      const normSQL = (s) => s.replace(/\s+/g, ' ').replace(/\s*;\s*$/, ';').trim().toLowerCase();

      const toast = (msg, type = 'info') => {
        const el = document.createElement('div');
        el.className = `alert alert-${type} position-fixed top-0 start-50 translate-middle-x mt-3 shadow`;
        el.style.zIndex = 1080;
        el.textContent = msg;
        document.body.appendChild(el);
        setTimeout(() => el.remove(), 2000);
      };

      // ======= Checkers =======
      function checkMCQ(block) {
        const answer = block.dataset.answer;
        const points = +block.dataset.points || 0;
        const selected = block.querySelector('input[type="radio"]:checked');
        const fb = block.querySelector('[data-feedback]');
        let earned = 0;
        if (!selected) { fb.innerHTML = '<span class="text-warning">Belum memilih opsi.</span>'; }
        else if (selected.value === answer) { earned = points; fb.innerHTML = '<span class="text-success">üéâ Tepat!</span>'; }
        else { fb.innerHTML = '<span class="text-danger">Kurang tepat. Jawaban benar: <strong>' + answer.toUpperCase() + '</strong></span>'; }
        return earned;
      }

      function checkInput(block) {
        const raw = block.querySelector('textarea, input').value.trim();
        const rules = JSON.parse(block.dataset.keywords || '[]');
        const fb = block.querySelector('[data-feedback]');
        const points = +block.dataset.points || 0;
        if (!raw) { fb.innerHTML = '<span class="text-warning">Masih kosong.</span>'; return 0; }
        let ok = false;
        for (const rule of rules) {
          if (rule.type === 'includes') {
            const any = (rule.any || []).some(k => raw.toLowerCase().includes(k.toLowerCase()));
            if (any) { ok = true; break; }
          } else if (rule.type === 'regex') {
            const re = new RegExp(rule.pattern, rule.flags || '');
            if (re.test(raw)) { ok = true; break; }
          }
        }
        fb.innerHTML = ok ? '<span class="text-success">Bagus! Jawaban memuat konsep kunci.</span>' : '<span class="text-danger">Coba lagi. Pastikan memuat kata kunci yang relevan.</span>';
        return ok ? points : 0;
      }

      function checkSQL(block) {
        const input = block.querySelector('input, textarea').value;
        const answers = JSON.parse(block.dataset.answers || '[]');
        const normInput = normSQL(input);
        const ok = answers.some(a => normSQL(a) === normInput);
        const fb = block.querySelector('[data-feedback]');
        const points = +block.dataset.points || 0;
        if (!input.trim()) { fb.innerHTML = '<span class="text-warning">Masih kosong.</span>'; return 0; }
        fb.innerHTML = ok ? '<span class="text-success">‚úîÔ∏è Benar</span>' : '<span class="text-danger">‚ùå Belum tepat</span>';
        return ok ? points : 0;
      }

      function checkDebug(block) {
        const input = block.querySelector('input').value;
        const target = block.dataset.correct || '';
        const ok = normSQL(input) === normSQL(target);
        const fb = block.querySelector('[data-feedback]');
        const points = +block.dataset.points || 0;
        if (!input.trim()) { fb.innerHTML = '<span class="text-warning">Masih kosong.</span>'; return 0; }
        fb.innerHTML = ok ? '<span class="text-success">‚úîÔ∏è Benar</span>' : '<span class="text-danger">‚ùå Belum tepat</span>';
        return ok ? points : 0;
      }

      // ======= Matching (Drag & Drop) =======
      function initMatching() {
        let dragged = null;
        document.querySelectorAll('#matchBank .drag-item').forEach(btn => {
          btn.addEventListener('dragstart', () => { dragged = btn; btn.classList.add('btn-info'); });
          btn.addEventListener('dragend', () => { dragged = null; btn.classList.remove('btn-info'); });
        });

        const zones = document.querySelectorAll('.dropzone-match');
        const removeDuplicates = (name) => {
          zones.forEach(z => {
            const placed = z.querySelector('.drag-item');
            if (placed && placed.dataset.item === name) { placed.remove(); }
          });
        };

        zones.forEach(zone => {
          zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('filled'); });
          zone.addEventListener('dragleave', () => zone.classList.remove('filled'));
          zone.addEventListener('drop', e => {
            e.preventDefault(); zone.classList.remove('filled');
            if (!dragged) return;
            const name = dragged.dataset.item;
            removeDuplicates(name);
            [...zone.children].forEach(c => c.remove());
            const clone = dragged.cloneNode(true);
            clone.classList.remove('btn-outline-info');
            clone.classList.add('btn-secondary');
            clone.setAttribute('draggable', 'false');
            const close = document.createElement('button');
            close.type = 'button';
            close.className = 'btn btn-sm btn-outline-light ms-2';
            close.textContent = '√ó';
            close.addEventListener('click', () => { clone.remove(); });
            const wrap = document.createElement('div');
            wrap.className = 'd-inline-flex align-items-center gap-2';
            wrap.appendChild(clone);
            wrap.appendChild(close);
            zone.appendChild(wrap);
          });
        });

        const resetBtn = document.getElementById('resetMatch');
        if (resetBtn) {
          resetBtn.addEventListener('click', () => {
            document.querySelectorAll('.dropzone-match').forEach(z => { z.innerHTML = ''; z.classList.remove('is-correct', 'is-wrong', 'filled'); });
            const fb = resetBtn.closest('[data-question="match"]').querySelector('[data-feedback]');
            if (fb) fb.innerHTML = '';
          });
        }
      }

      initMatching();

      function checkMatch(block) {
        const fb = block.querySelector('[data-feedback]');
        const map = JSON.parse(block.dataset.map || '{}');
        const points = +block.dataset.points || 0;
        const zones = block.querySelectorAll('.dropzone');
        let correct = 0, total = Object.keys(map).length;
        zones.forEach(z => {
          const target = z.dataset.target;
          const placed = z.querySelector('.drag-item');
          const name = placed ? placed.dataset.item : null;
          if (name && map[name] === target) { z.classList.add('is-correct'); z.classList.remove('is-wrong'); correct++; }
          else { z.classList.add('is-wrong'); z.classList.remove('is-correct'); }
        });
        const ok = correct === total;
        fb.innerHTML = ok ? `<span class="text-success">‚úîÔ∏è Semua cocok (${correct}/${total})</span>` : `<span class="text-danger">${correct}/${total} benar. Coba perbaiki pasangan yang salah.</span>`;
        return ok ? points : 0;
      }

      // ======= Skor & Reset =======
      function updateProgress() {
        const totalQuestions = blocks().length;
        const answered = blocks().reduce((n, b) => {
          const type = b.dataset.question;
          if (type === 'mcq') return n + (b.querySelector('input[type="radio"]:checked') ? 1 : 0);
          if (type === 'input' || type === 'sql' || type === 'debug') return n + ((b.querySelector('textarea, input')?.value.trim() || '').length > 0 ? 1 : 0);
          if (type === 'match') return n + (b.querySelectorAll('.dropzone-match .drag-item').length > 0 ? 1 : 0);
          return n;
        }, 0);
        lastAnswered = answered;
        const percent = totalQuestions ? Math.round((answered / totalQuestions) * 100) : 0;
        const bar = document.getElementById('progressBar');
        const txt = document.getElementById('progressText');
        if (bar) { bar.style.width = percent + '%'; bar.textContent = percent + '%'; bar.setAttribute('aria-valuenow', percent); }
        if (txt) { txt.textContent = `${answered}/${totalQuestions} soal terjawab ‚Ä¢ ${percent}% selesai`; }
      }

      function computeScore() {
        let score = 0;
        const detail = [];
        document.querySelectorAll('[data-question]').forEach((block, i) => {
          const type = block.dataset.question;
          let got = 0;
          if (type === 'mcq') got = checkMCQ(block);
          else if (type === 'input') got = checkInput(block);
          else if (type === 'sql') got = checkSQL(block);
          else if (type === 'debug') got = checkDebug(block);
          else if (type === 'match') got = checkMatch(block);
          score += got;
          detail.push({ no: i + 1, type, points: +(block.dataset.points || 0), got });
        });
        lastScore = score;
        document.getElementById('scoreBadge').textContent = `Skor: ${score} / ${MAX_POINTS}`;
        updateProgress();
        toast(`Skor kamu: ${score}/${MAX_POINTS}`, 'success');
        // store details for download
        window.__quizReport = { score, max: MAX_POINTS, answered: lastAnswered, name: (document.getElementById('studentName')?.value || '').trim(), detail };
      }

      function resetAll() {
        document.getElementById('scoreBadge').textContent = 'Skor: 0';
        document.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
        document.querySelectorAll('textarea, input[type="text"], input.form-control').forEach(i => { if (i.id !== 'studentName') i.value = ''; });
        document.querySelectorAll('[data-feedback]').forEach(f => f.innerHTML = '');
        document.querySelectorAll('.dropzone').forEach(z => { z.innerHTML = ''; z.classList.remove('is-correct', 'is-wrong', 'filled'); });
        lastScore = 0; lastAnswered = 0; updateProgress();
        toast('Kuis telah direset', 'info');
      }

      document.getElementById('checkAll').addEventListener('click', computeScore);
      document.getElementById('resetAll').addEventListener('click', resetAll);

      // Auto progress updates on input changes
      document.addEventListener('input', (e) => { if (e.target.matches('input, textarea')) updateProgress(); });
      document.addEventListener('change', (e) => { if (e.target.matches('input[type="radio"]')) updateProgress(); });
      updateProgress();

      // Download report
      const dl = document.getElementById('downloadReport');
      if (dl) {
        dl.addEventListener('click', () => {
          if (!window.__quizReport) computeScore();
          const now = new Date();
          const pad = n => String(n).padStart(2, '0');
          const stamp = `${now.getFullYear()}-${pad(now.getMonth() + 1)}-${pad(now.getDate())}_${pad(now.getHours())}-${pad(now.getMinutes())}`;
          const name = (document.getElementById('studentName')?.value || '').trim();
          const fname = `hasil-kuis${name ? '-' + name.replace(/[^a-z0-9]+/gi, '_') : ''}-${stamp}.txt`;
          const rpt = window.__quizReport || { score: 0, max: 0, answered: 0, name };
          const lines = [
            'Hasil Kuis Interaktif Basis Data',
            `Nama: ${rpt.name || '-'}`,
            `Tanggal: ${now.toISOString()}`,
            `Skor: ${rpt.score} / ${rpt.max}`,
            `Terjawab: ${rpt.answered} soal`,
            '',
            'Rincian:',
            ...(rpt.detail || []).map(d => `- No ${d.no} [${d.type}] : ${d.got}/${d.points}`)
          ].join('\n');
          const blob = new Blob([lines], { type: 'text/plain' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url; a.download = fname; a.click();
          URL.revokeObjectURL(url);
        })
      }
    });
  </script>
</body>

</html>